<br><br>
<div class="filter-icon-div"><span class="filter-class">Filters</span><mat-icon>filter_list</mat-icon></div>
<div class="header"> <mat-icon class="icon">keyboard_arrow_right</mat-icon>&nbsp;&nbsp;<span class="header-text">Study </span></div><br>

<ng-container *ngFor="let traj of data?.dataTrajectoryDTOList;let v of allAppliedVisitList; let j = index">
  <div class="header"> <mat-icon class="icon">keyboard_arrow_down</mat-icon>&nbsp;&nbsp;<span class="header-text">{{traj?.dataTrajectoryName}}</span></div>


<table id="mainTable">
    <tbody class="mainDiv" *ngFor="let expectedData of traj?.expectedDataCategoryDTOList;let visit of allAppliedVisitList[j]; let i = index">
    <tr class="table-header-color" *ngIf='!i'>
      <th >EXPECTED DATA CATEGORY</th>
      <th>APPLIED VISIT</th> 
      <th>SOURCE</th>
      <th>DATA TRANSFER FREQUENCY</th>
      <th>CRITICAL DATA</th>
      <th>ACTIONS</th>
    </tr>

    <tr *ngIf="rowstate[j][i]" [class.highlighted]="expectedData?.expectedDataCategoryName === selectedCat && j === selectedTraj">
        
        <td (click)="togglePanel(i,j)"> <mat-icon class="icon-1">{{arrowState[j][i]}}</mat-icon><span class="text-align">{{expectedData?.expectedDataCategoryName}}</span></td>
        <td>{{allAppliedVisitList[j][i]}}</td>
        <td>{{expectedData?.source}}</td>
        <td>{{expectedData?.dataTransferFrequency}}</td>
        <td>{{expectedData?.criticalData}}</td>
        <td class="action-row" id="act"><div class="align"><mat-icon (click)="edit(j,i)" class="action-icon">edit</mat-icon><mat-icon (click)="settings(expectedData.expectedDataCategoryName)" class="action-icon">settings</mat-icon> 
        <mat-icon (click)="delete(j,i)" class="action-icon">delete</mat-icon>
        <mat-icon (click)="comment(expectedData.expectedDataCategoryName)" class="action-icon">insert_comment</mat-icon>
        <div class="add-icon" (click)="addChecks(j,i,expectedData.expectedDataCategoryName)">
          <mat-icon class="action-icon">add_circle</mat-icon> 
        </div>
        </div>
        </td>
        </tr> 
   <!-- <tr id="hide-div"><td colspan="6"><div>This is the div</div></td></tr>-->
   <ng-container *ngIf="panelState[j][i] && expectedData?.idrpCheckDTOList !== null">
    <tr><td class="check-table" colspan="6">
     <table class="idrp-check-table" >
       <tr><th id="header-row"colspan="10">{{expectedData?.expectedDataCategoryName}} IDRP Checks</th></tr>
        <tr class="second-row" >
          <th>Purpose</th>
          <th>Description</th> 
          <th>Visit</th>
          <th>Role</th>
          <th>Method</th> 
          <th>Frequency</th>
          <th>Owner</th>
          <th>Check Name</th> 
          <th>Query Text</th>
          <th>Source</th>
        </tr>
        <tr class="second-table" *ngFor="let idrpCheck of expectedData?.idrpCheckDTOList; let i = index">
          <td>{{idrpCheck?.purpose}}</td>
          <td id="description">{{idrpCheck?.description}}</td> 
          <td>{{idrpCheck?.visit}}</td>
          <td>{{idrpCheck?.role}}</td>
          <td>{{idrpCheck?.method}}</td> 
          <td>{{idrpCheck?.frequency}}</td>
          <td>{{idrpCheck?.owner}}</td>
          <td>{{idrpCheck?.checkName}}</td> 
          <td>{{idrpCheck?.queryText}}</td>
          <td>{{idrpCheck?.source}}</td>

        </tr>
      </table>
    </td></tr></ng-container>
  </tbody>
</table><br><br>
</ng-container>
